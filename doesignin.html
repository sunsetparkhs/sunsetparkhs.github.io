<html lang="en"><head>
        <base href="/">
        <meta http-equiv="content-type" content="text/html; charset=UTF-8">
      <!--  <link rel='shortcut icon' type='image/x-icon' href='/ui/assets/img/favicon.ico' /> -->
	<meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
  
	
    <title>Sign In - NYC Public Schools</title>
    <meta name="description" content="Sign in page used by multiple NYC Department of Education websites for logging in.">
	
	<link rel="icon" href="https://www.nycenet.edu/ui/apps/resources/favicon/favicon.ico" sizes="any">
<link rel="icon" href="https://www.nycenet.edu/ui/apps/resources/favicon/favicon.svg" type="image/svg+xml">
<link rel="apple-touch-icon" href="https://www.nycenet.edu/ui/apps/resources/favicon/favicon-180.png">
<link rel="manifest" href="data:application/manifest+json,{
  &quot;icons&quot;: [
    {
      &quot;src&quot;: &quot;https://www.nycenet.edu/ui/apps/resources/favicon/favicon-192.png&quot;,
      &quot;type&quot;: &quot;image/png&quot;,
      &quot;sizes&quot;: &quot;192x192&quot;
    },
    {
      &quot;src&quot;: &quot;https://www.nycenet.edu/ui/apps/resources/favicon/favicon-512.png&quot;,
      &quot;type&quot;: &quot;image/png&quot;,
      &quot;sizes&quot;: &quot;512x512&quot;
    }
  ]
}">

	
	<style>
        /* Disable Edge default password reveal */
        ::-ms-reveal {
            display: none;
        }
    </style>

    <link rel="stylesheet" href="https://www.nycenet.edu/ui/apps/sites/sso/waves/css/sso.css" type="text/css">

        <title>Sign in - NYCDOE Cloud Identity</title>
        
        <script type="text/javascript" src="https://unpkg.com/@ungap/url-search-params@0.2.2/min.js"></script>

   <script>
 (function (w) {

    w.URLSearchParams = w.URLSearchParams || function (searchString) {
        var self = this;
        self.searchString = searchString;
        self.get = function (name) {
            var results = new RegExp('[\?&]' + name + '=([^&#]*)').exec(self.searchString);
            if (results == null) {
                return null;
            }
            else {
                return decodeURI(results[1]) || 0;
            }
        };
    }

})(window)

</script>

        <!-- script type="text/javascript" src="/idaas/mtfim/static/lsp.js?locale=en_US"></script -->
		
		<script>
        

		
var params = new URLSearchParams(document.location.search);
</script>


		<script>
		// START NON-TRANSLATABLE
		const action = "/authsvc/mtfim/sps/authsvc?StateId=7148c924-4d1b-468c-8ec2-15ae87ed65c3";
		const themeId = "default";
		var errorMessage = "";
		var isForgotUsernameEnabled = "false";
        var isForgotPasswordEnabled = "false";
		var username = "";
		var loginHint = ""
		// END NON-TRANSLATABLE
		</script>
		
		<script>
		
		function redirectBackToWF(){		
		//window.location.replace("/bpm/workflow/helper?reference=testwfmodelerv3&" + params.toString());
			document.getElementById("username-form").style.display = "block";
            document.getElementById("cloud-directory-form").style.display = "none";
		}		


	function showPasswordIcon() {
    const passwordInput = document.getElementById("password-input");
    const toggleButton = document.getElementById("toggle-password");
	
		
		if (passwordInput.value.trim() === "") {
		toggleButton.style.display = "none";
		}else {
			toggleButton.style.display = "block";		
			var errorFeedback = document.getElementById('cs-error-message');
			if (errorFeedback) {
				errorFeedback.innerText = "";
				csErrMessage.innerText="";
			}
			if(passwordInput){
			passwordInput.classList.remove("is-invalid");
			} 
		
		}    
	}	
	
		
		
	function togglePasswordVisibility() {
    const passwordInput = document.getElementById("password-input");
    const toggleButton = document.getElementById("toggle-password");

    if (passwordInput.type === "password") {
        passwordInput.type = "text";
        toggleButton.innerHTML = '<i class="fa-regular fa-eye-slash" title="Hide Password"></i>'; 
    } else {
        passwordInput.type = "password";
        toggleButton.innerHTML = '<i class="fa-regular fa-eye" title="Show Password"></i>'; 
    }
	}

	
		function rmemail(str){
		var ret = str.replace('@nycstudents.net','');
		ret=ret.replace('@schools.nyc.gov','');
		ret=ret.replace('@nycpublicschools.org','');
		document.Login.username.value=ret;
		}

  	   function trimEMail(str){
		var ret = str.toLowerCase().replace('@nycstudents.net','');
		ret=ret.replace('@schools.nyc.gov','');
		ret=ret.replace('@bers.nyc.gov','');
		ret=ret.replace('@nycpublicschools.org','');
		ret=ret.replace('@nycpublicschools.net','');
		return ret;
	}
	function setFedSettings()
	{
		//var origValue=document.getElementById("user-name-input").value;
		var origValue=document.getElementById("initial-user-name-input").value;	
		//var newValue=origValue.toLowerCase().replace('@nycstudents.net','').replace('@bers.nyc.gov','').replace('@schools.nyc.gov','');
		var newValue=trimEMail(origValue);
		document.getElementById("username").value=newValue;	
		document.getElementById("user-name-input").value=newValue;				
	}
		
		function imgLError(img,src){
			if(src=="L" && img.src.indexOf('.svg')>-1){
				img.src="/template/v1.0/static/logo.png";				
			}		
		}


		</script>

    </head>

	<body class="body-bg-image px-1 py-3 px-sm-4 py-sm-6 h-100">	

		<main class="container">	
		<div class="row">
	 <div class="col-sm-10 col-md-8 col-lg-12 col-xxl-10 offset-sm-1 offset-md-2 offset-lg-0 offset-xxl-1">
     <div class="title-form-card d-flex flex-column flex-lg-row shadow rounded-4 mb-6">
		 <div class="card" id="appIdentityCard">
                        <div class="card-body d-flex justify-content-center align-items-center">
                            <div class="d-flex flex-column gap-2 justify-content-center">
                                 <div class="d-flex justify-content-center" id="appIcon">
                                 <!--   <svg role="img" aria-label="DOE Logo" class="text-white" style="height:40px; width:227px"><use xlink:href="wwwroot/icons/doelogos.svg#doe-public-schools-horz"></use></svg> -->
									<img onerror="imgLError(this,'L')" src="https://www.nycenet.edu/ui/apps/sso-html/wwwroot/icons/doelogos/doe-public-schools-horz-white.svg" alt="NYC Public Schools Logo" style="height:40px; width:227px">
                                </div>
								
                                <div id="appTitle" style="display: none;">
                                    <div class="h5 mb-0 text-center text-white"></div>
                                </div>
                            </div>
                        </div>
         </div>		
				
				 <div class="card" id="signInCard">
                        
                        <h1 id="signIn_Header" class="mx-4 mt-6 mb-4 text-center">Sign In</h1>
                        <div id="signIn_SubHeader"></div>
                        
                        <!-- Changes for new opt -->
                        <div id="username-form" novalidate="" class="needs-validation mb-6 px-4 px-xxl-6">
			    <div class="form-inputs mb-4">
			        <label class="form-label" for="initial-user-name-input">Username or Email</label>
			        <input id="initial-user-name-input" type="text" class="form-control" name="initial-user-name-input" placeholder="User name" value="">
			         <div id="cs-error-message" class="text-danger mt-1"></div>
			    </div>
			    <div class="form-actions">
			        <div class="d-flex flex-column gap-1">
			            <button class="btn btn-success w-100 rounded-pill" id="username-button" value="login" type="button" href="doesignin2.html">Sign in</button>
			        </div>
			    </div>
                       </div>
                        <form id="cloud-directory-form" style="display:none" novalidate="" class="needs-validation mb-6 px-4 px-xxl-6" method="post">
						<div class="form-inputs mb-4">
						<button type="button" id="signInBackBtn" class="btn-danger-subtle btn btn-sm shadow-sm m-auto rounded-pill d-flex gap-3 justify-content-between align-items-center" onclick="redirectBackToWF()"><div class="d-flex gap-1 align-items-center">
						<img class="user-icon" id="userIcon" alt="person" style="height: 25px; width: 25px;">
						<span id="uname" class="user-email text-break d-inline-block"></span></div><i class="fa-solid fa-circle-chevron-left lh-1 fa-lg back-icon"></i></button></div>
                            
							<div class="form-inputs mb-4">
                                <label class="form-label" id="lbluser-name-input" style="display:none;" for="user-name-input">Username or Email</label> 
                               	<input id="user-name-input" type="text" style="display:none;" class="form-control" name="user-name-input" placeholder="User name" value=""> 
                               	
								
								<label class="form-label" for="password-input">Password</label> 
								<div id="input-container" class="password-input-wrapper" style="position: relative;">
								
								<input id="password-input" oninput="showPasswordIcon()" type="password" class="form-control" name="password" placeholder="Password" autocomplete="off" autofocus="">
								<button type="button" id="toggle-password" style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); cursor: pointer; background: none; border: none; display: block;" onclick="togglePasswordVisibility()" aria-label="Toggle Password Visibility">
								<i class="fa-regular fa-eye" title="Show Password"></i> 
								</button>
					
					
					<div id="cs-pwderror-message" class="text-danger mt-1"></div>
							
                            </div>
                            <div class="form-actions">
                                <div class="d-flex flex-column gap-1">
                                    <button class="btn btn-success w-100 rounded-pill" id="login-button" value="login" type="submit">Sign in</button>
                                </div>
                            </div>
							<input type="hidden" name="operation" value="verify">
						   <input type="hidden" name="username" id="username">
						         <div class="bottom-links text-center small pt-5 px-4 px-xxl-6" id="passwordLinks">								 
								 
                                <div class="d-flex flex-column gap-1" id="extlinks">
                               
                                </div> 
								</div>						
					

<script>
const errorMessages = {
  PASSWORD_FIELD_BLANK: "Password is required",
  PASSWORD_VALIDATION_FAIL: "Invalid password format",  
  UserName_Required:"Username is required"
};

const external_links = {
  EMP_PWD_PROFILE_MGMT: "https://idm.nycenet.edu/selfservice/Login.do",
  EMP_FORGOT_PWD: "https://idm.nycenet.edu/selfservice20/index.html",
  STUDENT_PWD_PROFILE_MGMT: "https://selfservice.schools.nyc/Profile/Index",
  STUDENT_PWD_RESET_ADMIN: "https://idmapps.nycenet.edu/passwordreset",
  STUDENT_FORGOT_PWD: "https://selfservice.schools.nyc/student",
  EXTERNAL_FORGOT_PWD: "https://idm.nycenet.edu/externalss/index.html",
  PARENT_FORGOT_PWD: "https://manage.schoolsaccount.nyc/forgotpassword?lc=en",
};

const icon_links = {
  student: "https://www.nycenet.edu/ui/apps/sso-html/wwwroot/icons/lineo/lin-student-outline.svg",
  person: "https://www.nycenet.edu/ui/apps/sso-html/wwwroot/icons/lineo/lin-person-circle.svg", 
  person_blue: "https://www.nycenet.edu/ui/apps/sso-html/wwwroot/icons/lineo/lin-person-circle-blue.svg",
  woman: "https://www.nycenet.edu/ui/apps/sso-html/wwwroot/icons/lineo/lin-woman-circle.svg",  
};


// Get form elements
const passwdForm = document.getElementById("cloud-directory-form");
const passwordInput = document.getElementById("password-input");
const passwordError = document.getElementById("cs-error-message");
const toggleButton = document.getElementById("toggle-password");
const uname = document.getElementById("uname");
const userNameInput = document.getElementById("user-name-input");
const userNameHfield = document.getElementById("username");
const signInBackBtn = document.getElementById("signInBackBtn");
const userIcon = document.getElementById("userIcon");
const targetDiv = document.getElementById('extlinks');

const urlParams = new URLSearchParams(window.location.search);	    
const login_hint = urlParams.get('login_hint');
const usertype = urlParams.get('usertype');
const uNameStep1 = document.getElementById('initial-user-name-input');

console.log(usertype)

if (signInBackBtn && userIcon && targetDiv) {

if(usertype === "1") {
  signInBackBtn.classList.remove("btn-danger-subtle");
  signInBackBtn.classList.add("btn-warning-subtle");
  userIcon.src = icon_links.student;
  
  var anchor1 = document.createElement('a');
  anchor1.className = 'btn btn-link btn-sm';
  anchor1.href = external_links.STUDENT_PWD_PROFILE_MGMT;
  anchor1.target= '_blank';
  anchor1.textContent = 'Password and Profile Management';
  
  var anchor2 = document.createElement('a');
  anchor2.className = 'btn btn-link btn-sm';
  anchor2.href = external_links.STUDENT_FORGOT_PWD;
  anchor2.target= '_blank';
  anchor2.textContent = 'Forgot Password?';
  targetDiv.appendChild(anchor1);
  targetDiv.appendChild(anchor2);

}

if(usertype === "2") {
  signInBackBtn.classList.remove("btn-danger-subtle");
  signInBackBtn.classList.add("btn-forest-subtle");
  userIcon.src = icon_links.person;
  
  var anchor1 = document.createElement('a');
  anchor1.className = 'btn btn-link btn-sm';
  anchor1.href = external_links.EMP_PWD_PROFILE_MGMT;
  anchor1.target= '_blank';
  anchor1.textContent = 'Password and Profile Management';
  
  var anchor2 = document.createElement('a');
  anchor2.className = 'btn btn-link btn-sm';
  anchor2.href = external_links.STUDENT_PWD_RESET_ADMIN;
  anchor2.target= '_blank';
  anchor2.textContent = 'Student Password Reset Admin';
  
  var anchor3 = document.createElement('a');
  anchor3.className = 'btn btn-link btn-sm';
  anchor3.href = external_links.EMP_FORGOT_PWD;
  anchor3.target= '_blank';
  anchor3.textContent = 'Forgot Password?';
  targetDiv.appendChild(anchor1);
  targetDiv.appendChild(anchor2);
  targetDiv.appendChild(anchor3);  
}

if(usertype === "3") {
  signInBackBtn.classList.remove("btn-danger-subtle");
  signInBackBtn.classList.add("btn-forest-subtle");
  userIcon.src = icon_links.person;
  
  var anchor1 = document.createElement('a');
  anchor1.className = 'btn btn-link btn-sm';
  anchor1.href = external_links.EMP_PWD_PROFILE_MGMT;
  anchor1.target= '_blank';
  anchor1.textContent = 'Password and Profile Management';
  
  var anchor2 = document.createElement('a');
  anchor2.className = 'btn btn-link btn-sm';
  anchor2.href = external_links.EMP_FORGOT_PWD;
  anchor2.target= '_blank';
  anchor2.textContent = 'Forgot Password?';
  targetDiv.appendChild(anchor1);
  targetDiv.appendChild(anchor2);
  
}
if(usertype === "4") {  
  userIcon.src = icon_links.woman;
  var anchor = document.createElement('a');
  anchor.className = 'btn btn-link btn-sm';
  anchor.href = external_links.PARENT_FORGOT_PWD;
  anchor.target= '_blank';
  anchor.textContent = 'Forgot Password?';
  targetDiv.appendChild(anchor);
  
} 
if(usertype === "5") {
  signInBackBtn.classList.remove("btn-danger-subtle");
  signInBackBtn.classList.add("btn-blue-subtle");
  userIcon.src = icon_links.person_blue;
  var anchor = document.createElement('a');
  anchor.className = 'btn btn-link btn-sm';
  anchor.href = external_links.EXTERNAL_FORGOT_PWD;
  anchor.target= '_blank';
  anchor.textContent = 'Forgot Password?';
  targetDiv.appendChild(anchor);  
}
}


if(login_hint){
uname.textContent=trimEMail(login_hint);
userNameInput.value=trimEMail(login_hint);
userNameHfield.value=trimEMail(login_hint);
uNameStep1.value=login_hint;
}

var errorString='';
var csErrMessage=document.getElementById("cs-pwderror-message");
csErrMessage.innerText="";
var errMsg="";
if(errorString.indexOf('CSIAH0303E')>-1){
   errMsg='Incorrect Username or Password';
var errorFeedback = document.getElementById('cs-error-message');
 if (errorFeedback) {
	errorFeedback.innerText = errMsg;
	csErrMessage.innerText=errMsg;
 }
const passwordInput = document.getElementById("password-input");
 if(passwordInput){
	passwordInput.classList.add("is-invalid");
	toggleButton.style.display = "none";
 }
}
  
  // Get the value of the password input
  const passwordValue = passwordInput.value; 
  						

  // Check for required field
  if (!passwordValue.trim()) {
    passwordError.textContent = errorMessages.PASSWORD_FIELD_BLANK;
	passwordInput.classList.add("is-invalid");
	 passwordInput.focus();
	 toggleButton.style.display = "none";
  } else if (/\s/.test(passwordValue)) { // Check for spaces
    passwordError.textContent = errorMessages.PASSWORD_VALIDATION_FAIL;
	passwordInput.classList.add("is-invalid");	
    passwordInput.focus();
	toggleButton.style.display = "none";	
  } else {
	var origValue=document.getElementById("user-name-input").value;	
	        var newValue=origValue.toLowerCase().replace('@nycstudents.net','').replace('@bers.nyc.gov','').replace('@schools.nyc.gov','').replace('@nycpublicschools.net','');
            document.getElementById("username").value=newValue;	
			document.getElementById("user-name-input").value=newValue;	
});
		
</script>
				</div></form>	
		
				<div class="alternate-options-dropdown separator" id="alternate-options-dropdown" style="display:none;">
            <div class="bx--form-item">
                <div class="bx--dropdown__wrapper ">
                    <ul data-dropdown="" data-value="" id="dropdown-id" class="bx--dropdown" tabindex="0">
                        <li class="bx--dropdown-text" id="dropdown-text">Sign in another way</li>
                        <li class="bx--dropdown__arrow-container">
                            <svg focusable="false" preserveAspectRatio="xMidYMid meet" style="will-change: transform;" xmlns="http://www.w3.org/2000/svg" class="bx--dropdown__arrow" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true"><path d="M8 11L3 6l.7-.7L8 9.6l4.3-4.3.7.7z"></path></svg>
                        </li>
                        <li>
                            <ul class="bx--dropdown-list" id="id-sources"></ul>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
</div>
</div>
</div>
</div></main>			
		
		
	<!-- Please do not move JS code from here, it may affect functionality -->

<script type="text/javascript" src="/authsvc/mtfim/sps/static/common.js"></script>

<script type="text/javascript" src="/authsvc/mtfim/sps/static/basicldapuser_login.js"></script> 

<script type="text/javascript">

window.onload = function() {
	if (typeof cookieDisableMessage !== 'undefined') {
		isCookieEnabled(cookieDisableMessage);
	}
}

function showForgotPasswordLink(isForgotPasswordEnabled) {
	if (isForgotPasswordEnabled === 'true') {
		document.getElementById('forgot-password-link').style.display = 'inline-block'
	}
}

function showForgotUsernameLink(isForgotUsernameEnabled) {
	if (isForgotUsernameEnabled === 'true') {
		document.getElementById('forgot-username-link').style.display = 'inline-block'
	}
}

//function startLoginStateRefreshTimeout() {
//	timeout(25, "/usc");
//}

function disableForm() {
	document.getElementById("login-main-form").disabled = true
}

function setError(errorMessage) {
	var field

	field = document.getElementById('user-name-input')
//	field.value = ''
	field.classList.add('error')

	field = document.getElementById('password-input')
	field.value = ''
	
	field.classList.add('error')

//	field = document.getElementById('login-error-message')
//  field.classList.add('active')

	field = document.getElementById('login-error-text')
	field.innerHTML = errorMessage
	setFocus()
}

window.showError = function (error) {
	if (error.trim() !== "") {
		setError(error.trim())
	}
}

window.setFocus = function () {
	var userNameField = document.getElementById("user-name-input")
	if (userNameField.value.trim() !== ""){
		document.getElementById('password-input').focus()
	} else {
		userNameField.focus()
	}
}

window.inputClick = function (event) {
	var inputField = event.currentTarget
	if (inputField.classList && inputField.classList.contains("error")) {
		if (inputField.id == "password-input") {
			var userNameInput = document.getElementById("user-name-input")
			if ((userNameInput) &&
				(userNameInput.value)) {
				resetInput(true)
			} else {
				resetInput()
			}
		} else {
			resetInput()
		}
	}
}

window.setError = function (errorMessage) {
	var field;

	field = document.getElementById('user-name-input');
	field.value = '';
	field.classList.add('error');

	field = document.getElementById('password-input');
	field.value = '';
	field.classList.add('error');
	

//	field = document.getElementById('login-error-message');
//  field.classList.add('active');

//	field = document.getElementById('login-error-text');
//	field.innerHTML = errorMessage;
	setFocus();
};

window.resetInput = function (keepUserNameInputValue) {
	var field

	field = document.getElementById('user-name-input')
	if (!keepUserNameInputValue) {
		field.value = ''
	}
	field.classList.remove('active')
	field.classList.remove('input-done')
	field.classList.remove('error')
	field = document.getElementById('user-name-label')
	field.classList.remove('active')
	field.classList.remove('input-done')
	field.classList.remove('error')

	field = document.getElementById('password-input')
	field.value = ''
	field.classList.remove('active')
	field.classList.remove('input-done')
	field.classList.remove('error')
	field = document.getElementById('password-label')
	field.classList.remove('active')
	field.classList.remove('input-done')
	field.classList.remove('error')
	field = document.getElementById('login-error-message')
	field.classList.remove('active')
}

</body></html>
